This is paper from this thesis.